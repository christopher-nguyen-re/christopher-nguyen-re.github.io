x/40x $rsp
r
fini
fini
fini
fini
x/40x $rsp
fini
x/40x $rsp
c
fini
fini
fini
fini
fini
x/60x $rsp
c
c
x/40x $rsp
ni
x/60x $rsp
c
quit
c
c
x/40x $rsp
x/80x $rsp
function 
disassemble do_stuff
b *0x00000000004006fe
c
ni
b do_stuff 
c
b *0x4006fe
c
x/20x 0x7ffff241abf0
ni
x/20x 0x7ffff241abf0
x/6x 0x7ffff241abf0
x/60x 0x7ffff241abf0
b do_stuff 
c
ni
ni
x/60x 0x7ffef94ccce0
c
x/80x 0x7ffef94ccce0
b do_stuff 
c
b *0x4006fe
c
b *0x400719
ni
x/80x $rsp
c
x/c 0x7fff6a40764f
x/10x 0x7fff6a40764f
ni
x/80x 0x7fff6a40764f
disassemble do_stuff 
b 0x0000000000400769
b *0x0000000000400769
c
got
si
starti
got
x 0x400546
got
c
c
put
got
c
put
got
c
got
x/80x $rsp
c
x/80 $rsp
x rop.find_gadget(['pop rdi', 'ret'])[0]
x 0x7f770ccf5ea0
got
b do_stuff 
c
ni
x/80x 0x7fffb373d690
ni
x/80x 0x7fffb373d690
ni
ni
x/80x 0x7fffb373d690
ni
disassemble do_stuff 
b *0x0000000000400769
c
x/80x 0x7fffb373d690
ni
fini
c
x/80x 0x7fffb373d690
b do_stuff 
c
disassemble do_stuff 
b *0x00000000004006fe
c
x/80 $rsp
x/80x $rsp
c
disassemble do_stuff 
b *0x0000000000400769
c
x/80x $rsp
x/80x 0x7fffb373d690
b do_stuff 
c
disassemble do_stuff 
b *0x00000000004006fe
c
x/80x 0x7ffcdedb42c0
disassemble do_stuff 
b *0x0000000000400769
c
ni
disassemble do_stuff 
ni
ni
fini
x/80x 0x7ffcdedb42c0
x 7fa2bd73ca30
x 0x7fa2bd73ca30
got
c
c
c
c
c
got
c
b do_stuff 
c
disassemble do_stuff 
b *0x0000000000400770
c
ni
fini
disassemble do_stuff 
b *0x00000000004006fe
c
ni
x/80 0x7ffd727d3d90
x/80x 0x7ffd727d3d90
c
ni
ni
ni
c
c
x/40x $rsp
b do_stuff 
c
x/40x $rsp
disassemble do_stuff 
b *0x0000000000400770
c
x/40x $rsp
c
ls
pwd
c
c
pwd
pwd
pwd
c
c
disassemble do_stuff 
b *0x0000000000400770
c
x/80x $rsp
ni
x/80x $rsp
ni
x/80x $rsp
ni
ni
fini
ni
pwd
exit
disassemble do_stuff 
b *0x0000000000400770
c
x/40x $rsp
ni
n
n
fini
ni
x/40x $rsp
ni
x/40x $rsp
c
ls
quit
c
c
c
c
c
c
disassemble do_stuff 
b *0x0000000000400770
c
ni
ni
ni
fini
ni
ni
ni
c
c
exit
disassemble do_stuff 
b *0x0000000000400770
c
c
c
disassemble do_stuff 
b *0x0000000000400770
c
ni
c
disassemble do_stuff 
b *0x0000000000400770
c
c
ni
ni
ni
c
disassemble do_stuff 
b *0x0000000000400770
c
c
ni
c
disassemble do_stuff 
b *0x0000000000400770
c
set follow-fork-mode child
c
c
